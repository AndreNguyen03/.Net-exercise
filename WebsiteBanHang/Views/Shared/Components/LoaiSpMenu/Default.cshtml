@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

@model IEnumerable<TLoaiSp>
<div class="col-lg-3">
	<div class="hero__categories">
		<div class="hero__categories__all">
			<i class="fa fa-bars"></i>
			<span>All departments</span>
		</div>
		<ul>
			@foreach (var item in Model)
			{
				var getUrl = "http://localhost:5093/api/v1/productapi/" + item.MaLoai;
				<li>
					<a style="cursor:pointer" onclick="showProductByCategory('@getUrl')">@item.Loai</a>
				</li>
				@* <li>
			<a asp-controller="Home" asp-action="SanPhamTheoLoai"
			asp-route-maloai="@item.MaLoai">@item.Loai</a>
			</li> *@
			}
		</ul>
	</div>
</div>

@* <script>
	const showProductByCategory = function (getUrl) {
		var str = '';
		$.ajax({
			type: 'GET',
			url: getUrl,
			dataType: 'json',
			success: function (data) {
				$.each(data, function (key, val) {

				str += '<div class="col-lg-3 col-md-4 col-sm-6 mix oranges fresh-meat">';
				str += '<div class="featured__item">';
				str += '<div class="featured__item__pic set-bg" data-setbg=\"'
				var linkImage = "../Images/" + $.trim(val.anhDaiDien);
				str += linkImage;
				str += '\" style = "background-image: url(&quot;';
				str += linkImage;
				str += '&quot;)">'
				str += '<ul class="featured__item__pic__hover" >';
				str += '<li><a href="#"> <i class="fa fa-heart"> </i></a> </li>';
				str += '<li> <a href="#"> <i class="fa fa-retweet"> </i></a> </li>';
				str += '<li> <a href="#"> <i class="fa fa-shopping-cart"> </i></a> </li>';
				str += '</ul></div>';
				str += '<div class="featured__item__text">';
				str += '<h6><a href=\"Home/ProductDetail?maSp=';
				str += $.trim(val.tenSp);
				str += '\">';
				str += $.trim(val.tenSp);
				str += '</a></h6><h5>';
				str += val.giaNhoNhat.toString();
				str += '</h5></div></div></div>';
			});
		$('#displayProducts').html(str);
	},
		Error: function (xhr) {
			alert(xhr.responseText)
				}
			})
		}
</script> *@


<script>
	const showProductByCategory = async (getUrl) => {
		try {
			const response = await fetch(getUrl); // Gọi API với Fetch
			if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);

			const data = await response.json(); // Chuyển đổi dữ liệu về JSON
			let str = '';

			data.forEach(val => {
				const linkImage = `../Images/${val.anhDaiDien.trim()}`;

				str += `
					<div class="col-lg-3 col-md-4 col-sm-6 mix oranges fresh-meat">
						<div class="featured__item">
							<div class="featured__item__pic set-bg"
								 data-setbg="${linkImage}"
								 style="background-image: url('${linkImage}')">
								<ul class="featured__item__pic__hover">
									<li><a href="#"><i class="fa fa-heart"></i></a></li>
									<li><a href="#"><i class="fa fa-retweet"></i></a></li>
									<li><a href="#"><i class="fa fa-shopping-cart"></i></a></li>
								</ul>
							</div>
							<div class="featured__item__text">
								<h6><a href="Home/ProductDetail?maSp=${val.tenSp.trim()}">
									${val.tenSp.trim()}
								</a></h6>
								<h5>${val.giaNhoNhat}</h5>
							</div>
						</div>
					</div>`;
			});

			$('#displayProducts').html(str); // Render sản phẩm
		} catch (error) {
			alert(`Error: ${error.message}`); // Xử lý lỗi
		}
	};
</script>
